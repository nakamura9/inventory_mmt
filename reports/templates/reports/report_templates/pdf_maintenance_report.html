<!DOCTYPE html>
<html>
    <head>
        {% load static %}
        <meta name="charset" content="utf-8" >
        <meta name="viewport" content="width=device-width, initial-scale=1" >
        <style>
            .well {
                border-radius: 5px;
                padding: 10px;
                margin: 10px;
                border: 1px solid grey;
            }

            .table tr{
                border-bottom: 1px solid grey;
            }

            .table td{
                padding: 3px;
                text-align: left;
            }
        </style>
    </head>
    <body>
<div class="page-layout">
    <div class="page-content">
        <h2>Maintenance Report</h2>
        <h4><b><u>Report Summary</u></b></h4>
        <div class="well">
            <ul >
                <li>The report covers the period from {{object.start_period}} to {{object.end_period}}</li>
                {% if object.machine.count != 0 %}
                <li>The equipment covered in this report consists of {% for mech in object.machine.all %}{{mech}} {% endfor %}</li>
                {% else %}
                <li>The scope of this report is all machines</li>
                {% endif %}
                <li>Over this period, there were {{wos.all.count}} breakdowns resulting in {{total_downtime}} hours of downtime </li>
            </ul>
        </div>
        
        
        <h3><u><b>Planned maintenance over the period</b></u></h3>
        <h4><b>Preventative Tasks</b></h4>
        
        <table class="table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Machine</th>
                    <th>Planned Hours</th>
                    <th>Actual Hours Taken</th>
                </tr>
            </thead>
            <tbody>
                {% for task in p_tasks %}
                <tr>
                    <td>{{task.completed_date}}</td>
                    <td>{{task.machine}}</td>
                    <td>{{task.estimated_labour_time}}</td>
                    <td>{{task.actual_downtime}}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
        <h4><b>Checklists</b></h4>
        
        
        <table class="table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Machine</th>
                    <th>Title</th>
                    <th>Time Taken</th>
                </tr>
            </thead>
            <tbody>
                {% for check in checks %}
                <tr>
                    <td>{{check.last_completed_date}}</td>
                    <td>{{check.machine}}</td>
                    <td>{{check.title}}</td>
                    <td>{{check.estimated_time}}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
        
        <h3><u><b>Breakdowns over period</b></u></h3>
        
        <table class="table">
            <thead>
                <tr>
                    <th>Machine</th>
                    <th>Problem</th>
                    <th>Time Taken</th>
                    <th>Corrective action</th>
                </tr>
        
            </thead>
            <tbody>
                    {% for wo in wos %}
                <tr>
                    
                    <td>{{wo.machine}}</td>
                    <td>{{wo.description}}</td>
                    <td>{{wo.actual_labour_time}}</td>
                    <td>{{wo.resolver_action}}</td>
                    
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
        <h3>Machine Availability Graphs</h3>
        <div class="report-images">
            {% for path in graph_images %}
            <div style="margin-top: .5cm;">
                <img alt="Graph not found" width="700" height="400" src="{{path}}" >
            </div>
            {% endfor %}
        </div>
        <p>This report was authored by {{object.author.first_name}} {{object.author.last_name}} on the {{object.created}}. </p>
    </div>
    </div>
</body>
</html>